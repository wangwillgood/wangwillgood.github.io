<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>凌云壮志几多愁</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Widgets Extensions实践简介和注意事项Widgets Extensions在Apple众多App Extensions 中的Today，其设计目的是为了能让用户更快捷的操作自己感兴趣的事情。">
<meta property="og:type" content="article">
<meta property="og:title" content="凌云壮志几多愁">
<meta property="og:url" content="https://wangwillgood.github.io/2016/10/14/SwiftWidget/index.html">
<meta property="og:site_name" content="凌云壮志几多愁">
<meta property="og:description" content="Widgets Extensions实践简介和注意事项Widgets Extensions在Apple众多App Extensions 中的Today，其设计目的是为了能让用户更快捷的操作自己感兴趣的事情。">
<meta property="og:image" content="https://wangwillgood.github.io/upload/swiftwidget1.png">
<meta property="og:image" content="https://wangwillgood.github.io/upload/swiftwidget2.png">
<meta property="og:updated_time" content="2016-10-18T10:55:28.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="凌云壮志几多愁">
<meta name="twitter:description" content="Widgets Extensions实践简介和注意事项Widgets Extensions在Apple众多App Extensions 中的Today，其设计目的是为了能让用户更快捷的操作自己感兴趣的事情。">
<meta name="twitter:image" content="https://wangwillgood.github.io/upload/swiftwidget1.png">
  
    <link rel="alternative" href="/atom.xml" title="凌云壮志几多愁" type="application/atom+xml">
  
  
    <link rel="icon" href="//favicon.png">
  
  <script src="/style.js"></script>
  

</head>

<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="avatar.JPG" class="js-avatar show">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Will</a></h1>
		</hgroup>

		
		<p class="header-subtitle">男儿不展风云志，空负天生八尺躯</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/archives">所有</a></li>
	        
				<li><a href="/iosarticle">技术</a></li>
	        
				<li><a href="/tags/随笔">随笔</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="1" href="javascript:void(0)">标签</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="2" href="javascript:void(0)">友链</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="3" href="javascript:void(0)">关于我</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/wangwangok" title="github">github</a>
		        
					<a class="weibo" target="_blank" href="http://weibo.com/wwloading" title="weibo">weibo</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">Will</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="avatar.JPG" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">Will</h1>
			</hgroup>
			
			<p class="header-subtitle">男儿不展风云志，空负天生八尺躯</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有</a></li>
		        
					<li><a href="/iosarticle">技术</a></li>
		        
					<li><a href="/tags/随笔">随笔</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/wangwangok" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/wwloading" title="weibo">weibo</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        <article id="post-SwiftWidget" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Widgets-Extensions实践"><a href="#Widgets-Extensions实践" class="headerlink" title="Widgets Extensions实践"></a>Widgets Extensions实践</h1><h4 id="简介和注意事项"><a href="#简介和注意事项" class="headerlink" title="简介和注意事项"></a>简介和注意事项</h4><p>Widgets Extensions在Apple众多<a href="https://developer.apple.com/library/content/documentation/General/Conceptual/ExtensibilityPG/Action.html#//apple_ref/doc/uid/TP40014214-CH13-SW1" target="_blank" rel="external">App Extensions</a> 中的<code>Today</code>，其设计目的是为了能让用户更快捷的操作自己感兴趣的事情。<br><br><img src="/upload/swiftwidget1.png" alt="Widget"></p>
<a id="more"></a>
<p>Apple在描述它是这样描述的</p>
<pre>
App extensions in the Today view are called widgets.Widgets give users quick access to information that’s important right now. <br>For example, users open the Today view to check current stock prices or weather conditions, see today’s schedule, or perform a quick task such as marking an item as done. <br>Users tend to open the Today view frequently, and they expect the information they’re interested in to be instantly available.
</pre>
我来粗略的翻译一下就是说：<br>
<pre>
在手机通知中心(或者在iOS10及其以上版本中主界面,锁屏界面左滑)"今天"视图中的App Extensions叫做"Widget"。<br>Widget的目的是为了方便用户能够快速对自己感兴趣的东西快速的做出相应动作。
</pre>

<blockquote>
<p>注意事项<br><br>1.Widget最好只是做一些很容易更新很简单的任务，最好不用把他用在需要多步或者很长任务中。<br><br>2.避免在Widgets放入一个ScrollView</p>
</blockquote>
<p>上面的提到的注意事项特别是不要放入ScrollView及其子类相关是要特别注意的。通过介绍了上面这么多的概念和注意事项之后，先来实践一边吧。</p>
<h4 id="Getting-Start"><a href="#Getting-Start" class="headerlink" title="Getting Start"></a>Getting Start</h4><p>样例工程是由Swift写的，<br>Widget并不是独立存在的，所以你需要先创建一个Project(这里我的Project名为<code>WidgetDemo</code>)，然后我们一步一步来创建自己的Widget吧。<br></p>
<p><ol></ol></p>
<p><li>首先我们必须先创建一个<code>Today Extension</code>，具体创建步骤为<code>File -&gt; New -&gt; Target -&gt; Today Extension</code>点击next并输入您的Extension名称(名称<code>cdfer</code>)，回车之后你会在左边的文件列表中看到自己刚刚创建的Target了。</li></p>
<p><li>现在你需要点击进入<code>WidgetDemo</code>,并选中<code>TARGETS</code>下面的<code>cdfer</code>,点击Capabilities按钮，将<code>App Group</code>的switch处于<code>on</code>的状态，并点击<code>+</code>创建一个App Group(我这里的名为:<code>group.widgetdemo.blog</code>)。</li></p>
<p><li>选中在同一个<code>TARGETS</code>下的主工程target，也就是我前面创建的<code>WidgetDemo</code>。同样点击Capabilities按钮，并将App Group按钮打开，最后将你刚刚创建的App Group钩上就可以关联上了。</li><br><br>到这里我们就成功创建了包涵<code>Today Extension</code>的project，点击运行就能在<code>今天</code>页面添加你自己创建的Widget，清晰地看见Hello word。<br><br>然后我们继续往下走！</p>
<h4 id="UI"><a href="#UI" class="headerlink" title="UI"></a>UI</h4><blockquote>
<p>IMPORTANT<br><br>建议最好使用AutoLayout来设计Today widget的界面</p>
</blockquote>
<h4 id="自定义控制器"><a href="#自定义控制器" class="headerlink" title="自定义控制器"></a>自定义控制器</h4><p>通过以上步骤，打开<code>cdfer</code>文件目录下可以看到一个<code>TodayViewController</code>和一个<code>MainInterface.storyboard</code>和<code>Info.plist</code>.<br><br>如果我们不想使用Apple给我们提供的TodayViewController模版呢，而是想自己创建一个Controller呢？办法肯定是有的～～～<br><br>在Apple Developer中有明确的说了解决办法:<br></p>
<p><pre><br>iOS. If you don’t want to use the storyboard file provided by the template, remove the NSExtensionMainStoryboard key and add the NSExtensionPrincipalClass key, using the name of your view controller for the value.<br></pre><br>意思就是说如果你不想使用Apple提供的StoryBoard的模版的话，你可以在plist文件中移除<code>NSExtensionMainStoryboard</code>对应的键值对，然后再添加<code>NSExtensionPrincipalClass</code>,这个key对应的value就是你想自定义的controller的名称。<br>这很简单，但是这里有一个坑，如果你使用Swift工程来照着做的话，是肯定会出现程序崩溃的！他会报错<code>NSExtensionPrincipalClass</code>对应值拿不到，所以<code>NSExtensionPrincipalClass</code>对应的key需要修改一下:<br></p>
<p><pre><br>\<key\>NSExtensionPrincipalClass\<br>\<string>“your extension name”.CustomTodayViewController\</string><br>比如:<br>\<key\>NSExtensionPrincipalClass\<br>\<string>cdfer.CustomTodayViewController\</string><br></key\></key\></pre><br><img src="/upload/swiftwidget2.png" alt="WidgetCustom"><br><br>通过上面的修改就能使用自定义的Controller了。</p>
<p>推荐:<br><br><a href="https://developer.apple.com/library/content/documentation/General/Conceptual/ExtensibilityPG/Today.html#//apple_ref/doc/uid/TP40014214-CH11-SW1" target="_blank" rel="external">Apple Developer For Today</a></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/10/14/SwiftWidget/" class="archive-article-date">
  	<time datetime="2016-10-14T07:27:57.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-10-14</time>
</a>
      
      

      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2016/10/25/swift3_UnsafePointer/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2016/10/13/iosarticle/index/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">技术</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>




<div class="share_jia">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">Share to: &nbsp; </span>
		<a class="jiathis_button_facebook"></a> 
	    <a class="jiathis_button_twitter"></a>
	    <a class="jiathis_button_plus"></a> 
	    <a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>









      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Will
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js"></script>


    
<div class="tools-col">
  <ul class="btn-wrap">
    
      <li class="chose" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
    
    
      <li data-hook="tools-section-tag"><span class="text">标签</span><i class="icon-price-tags"></i></li>
    
    
      <li data-hook="tools-section-friends"><span class="text">友链</span><i class="icon-link"></i></li>
    
    
      <li data-hook="tools-section-me"><span class="text">我</span><i class="icon-smile"></i></li>
    
  </ul>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all chose">
    	</section>
    

    
    	<section class="tools-section tools-section-tag">
    			<div class="widget tagcloud" id="js-tagcloud">
    				
    			</div>
    	</section>
    

    
    	<section class="tools-section tools-section-friends">
  		
  			<div class="friends-wrap" id="js-friends">
  			
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://weibo.com/wwloading/profile?rightmod=1&wvr=6&mod=personinfo&is_all=1">友情链接</a>
  	        
  	        </div>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">我是一个很菜的技术猿&lt;br&gt;&lt;br&gt;我还需要慢慢的成长&lt;br&gt;希望能来到这里的你，能帮助我更快的成长</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>